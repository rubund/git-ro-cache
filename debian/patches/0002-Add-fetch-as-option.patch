From: Ruben Undheim <ruben.undheim@gmail.com>
Date: Sat, 5 Nov 2016 09:37:39 +0100
Subject: Add fetch as option

---
 python/gitroc/client.py    | 8 ++++++--
 python/gitroc/workspace.py | 4 ++--
 2 files changed, 8 insertions(+), 4 deletions(-)

diff --git a/python/gitroc/client.py b/python/gitroc/client.py
index fef035e..4ff3c66 100644
--- a/python/gitroc/client.py
+++ b/python/gitroc/client.py
@@ -48,7 +48,7 @@ def recvall(sock, n):
 
 
 class GitrocClient:
-    def __init__(self, destdir=".", gitroc_server=None):
+    def __init__(self, destdir=".", gitroc_server=None, fetch=False):
         self.basedir = destdir
         if not gitroc_server: # If no server is given, use the local server
             gitroc_server = "localhost"
@@ -57,6 +57,7 @@ class GitrocClient:
         self.number = 0
         self.destsubdir = {}
         self.localname = {}
+        self.fetch = fetch
 
     def request_url(self, fullurl, localname=None, branch="master", destsubdir=""):
         url = ""
@@ -70,7 +71,10 @@ class GitrocClient:
         data['reponame'] = reponame+""+suffix
         data['url'] = url
         data['commit'] = branch
-        data['mode'] = 0
+        if self.fetch:
+            data['mode'] = 0
+        else:
+            data['mode'] = 1
         data['number'] = self.number
         data['version'] = 2
         jsondata = json.dumps(data)
diff --git a/python/gitroc/workspace.py b/python/gitroc/workspace.py
index 8bdc9cd..2c61d79 100644
--- a/python/gitroc/workspace.py
+++ b/python/gitroc/workspace.py
@@ -32,8 +32,8 @@ class Workspace:
         self.nworkers = 8
         pass
 
-    def checkout(self):
-        c = client.GitrocClient(destdir=self.path)
+    def checkout(self, fetch=False):
+        c = client.GitrocClient(destdir=self.path, fetch=fetch)
         for e in self.cfg.elements:
             if e.rw:
                 self.rwqueue.put(e)
